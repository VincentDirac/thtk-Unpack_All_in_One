# 自用一键式东方正作全解包

（其实就是个调包脚本）

## 依赖

本工具在解包过程中仅需要使用thtk。后续可选的转换编码和生成BGM相关内容处理中，需要本地安装python并添加至环境变量中，版本至少为3.8为好，你可能还需要chardet和numpy。如果需要利用最后一步将wav转为MP3格式，你还需要有FFmpeg并将其添加到环境变量中。

## 用法

将游戏所在文件夹拖动到```一键解包.bat```上，根据提示适当的按```回车键```，或者输入```y```和```n```，即可获得足够有用的全部原作素材（（  
那么，就请利用这些素材尽情地二创吧！

点击```点击清空解包文件.bat```可清空所有生成内容。

## 支持性

至少可用于最新几部东方正作。仅测试了鬼形兽、虹龙洞、兽王园及锦上京，其他作未测试，可能会有bug。部分bug可能为thtk工具本身所致，如thtk工具本身报错，请询问thtk开发者。

## 包含内容

### thtk

thtk是由西方大佬编写的一套东方正作解包工具集（不支持旧作、游泳作和刚欲异闻），项目源地址：<https://github.com/thpatch/thtk>
可自行编译，这里直接给出来自官方的nightly build，源地址：<https://nightly.link/thpatch/thtk/workflows/build/master>
解包的相关参数已预设。如果需要自定义，请直接使用thtk，并不需要此脚本。

### thbgm.py

thbgm-unpack
项目源地址：<https://gitee.com/wdsjimin/thbgm-unpack>
我略微进行了修改，以使输出的音频包含3s淡出。

### shift_jis_to_utf-8.py

将文本文件中恼人的shift_jis编码转换为utf-8。纯粹从网络来的，忘记参考哪的了。一些文本编辑器在打开txt文件时会自动用适合的编码打开。

### transBFA.py

用于把BgmForAll.ini中的文件名替换成曲目名，暴力循环（

### 一键解包.bat

主要的批处理脚本。

### 点击清空解包文件.bat

为了避免拆不同游戏的内容混淆以及删旧文件删半天写的。

### transDialogue.py

试图从msg文件内提取信息生成可用于编辑wikitext以减少工作量，但最后弃坑。

## 说明

纯娱乐练手内容。还有诸多可拓展和改进之处。

## 感谢

感谢博丽神主ZUN，感谢THPatch及THBWiki。
